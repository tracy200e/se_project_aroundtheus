!function(){"use strict";var e={960:function(e,t,s){e.exports=s.p+"df100efc54d4645073d7.jpg"},656:function(e,t,s){e.exports=s.p+"8edfe6cd78e39aafc871.jpg"},822:function(e,t,s){e.exports=s.p+"44e6fede87f55e5327cc.jpg"},328:function(e,t,s){e.exports=s.p+"e463b225f0897d749d63.jpg"},994:function(e,t,s){e.exports=s.p+"70aac30a40409c4dbc71.jpg"},339:function(e,t,s){e.exports=s.p+"2e37fd0c260a298af732.jpg"}},t={};function s(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,s),r.exports}s.m=e,s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.b=document.baseURI||self.location.href,function(){const e=[{name:"Lago di Braies",link:new URL(s(656),s.b)},{name:"Vanoise National Park",link:new URL(s(994),s.b)},{name:"Lake Louise",link:new URL(s(822),s.b)},{name:"Latemar",link:new URL(s(328),s.b)},{name:"Bald Mountains",link:new URL(s(960),s.b)},{name:"Yosemite Valley",link:new URL(s(339),s.b)}];class t{constructor(e,t){let{data:s,handleImageClick:n}=e;this._name=s.name,this._link=s.link,this._cardSelector=t,this._handleImageClick=n}_setEventListeners(){this._likeButton=this._element.querySelector(".card__like-button"),this._likeButton.addEventListener("click",this._handleLikeIcon),this._element.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteCard())),this._imageWindow=this._element.querySelector(".card__image"),this._imageWindow.addEventListener("click",(()=>this._handleImageClick({link:this._link,name:this._name})))}_handleLikeIcon=()=>{this._likeButton.classList.toggle("card__like-button_active")};_handleDeleteCard(){this._element.remove(),this._element=null}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getView(){this._element=this._getTemplate();const e=this._element.querySelector(".card__image");return e.src=this._link,e.alt=`Photo of ${this._name}`,this._element.querySelector(".card__title").textContent=this._name,this._setEventListeners(),this._element}}class n{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputList=this._form.querySelectorAll(this._inputSelector),this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleInputState(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_checkValidity(e){return!e.validity.valid}_hasInvalidInput=()=>Array.from(this._inputList).some(this._checkValidity);_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_setEventListeners(){this.disableButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._toggleInputState(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}}class o{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeButton=this._popupElement.querySelector(".modal__close-button")}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{e.target===e.currentTarget&&this.close()})),this._closeButton.addEventListener("click",(()=>this.close()))}}class r extends o{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".form__button"),this._formInputs=this._popupForm.querySelectorAll("input"),this._handleFormSubmit=t}_getInputValues(){const e={};return this._formInputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}close(){this._popupForm.reset(),super.close()}}const i=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),a=document.querySelector("#name"),c=document.querySelector("#profession"),u=document.forms["profile-form"],_=document.forms["card-form"],d={};var m;m={inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible",formSelector:"form"},Array.from(document.querySelectorAll(m.formSelector)).forEach((e=>{const t=new n(m,e),s=e.getAttribute("name");d[s]=t,t.enableValidation()}));const h=new class extends o{constructor(e){super({popupSelector:e}),this._imageElement=this._popupElement.querySelector(".modal__image"),this._imageCaption=this._popupElement.querySelector(".modal__name"),super.setEventListeners()}open(e){this._imageElement.src=e.link,this._imageElement.alt=`Image ${e.name}`,this._imageCaption.textContent=e.name,super.open()}}("#image-modal");function p(e){return new t({data:e,handleImageClick:e=>{h.open(e)}},"#card-element").getView()}h.close();const f=new class{constructor(e,t){let{items:s,renderer:n}=e;this._renderedItems=s,this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._renderedItems.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:e,renderer:e=>{const t=p(e);f.addItem(t)}},".cards__list");f.renderItems(e);const E=new r("#add-modal",(e=>{const t=p(e);E.close(),f.addItem(t)}));l.addEventListener("click",(()=>{d[_.getAttribute("name")].resetValidation(),E.open()})),E.setEventListeners();const v=new class{constructor(e,t){this._name=document.querySelector(e),this._profession=document.querySelector(t)}getUserInfo(){return{name:this._name.textContent,profession:this._profession.textContent}}setUserInfo(e,t){this._name.textContent=e,this._profession.textContent=t}}(".profile__name",".profile__profession"),b=new r("#edit-modal",(e=>{v.setUserInfo(e.name,e.profession),b.close()}));i.addEventListener("click",(()=>{const e=v.getUserInfo();a.value=e.name,c.value=e.profession,d[u.getAttribute("name")].disableButton(),b.open()})),b.setEventListeners()}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Y29ILEVBQzlDLENBR0FFLGNBQ0ksTUFBTyxDQUNIdkksS0FBTVMsS0FBS0MsTUFBTXNCLFlBQ2pCd0csV0FBWS9ILEtBQUs2SCxZQUFZdEcsWUFFckMsQ0FHQXlHLFlBQVl6SSxFQUFNd0ksR0FDZC9ILEtBQUtDLE1BQU1zQixZQUFjaEMsRUFDekJTLEtBQUs2SCxZQUFZdEcsWUFBY3dHLENBQ25DLEdSd0JhLGlCQUNNLHdCS2dHakJFLEVBQWdCLElBQUlwRCxFTG5HUCxlS21HK0NxRCxJQUc5RFIsRUFBU00sWUFBWUUsRUFBTzNJLEtBQU0ySSxFQUFPSCxZQUd6Q0UsRUFBYzFELE9BQU8sSUFRekJpQixFQUFXL0UsaUJBQWlCLFNBQVMsS0FHakMsTUFBTTBILEVBQWNULEVBQVNJLGNBRzdCcEMsRUFBY0osTUFBUTZDLEVBQVk1SSxLQUNsQ29HLEVBQW9CTCxNQUFRNkMsRUFBWUosV0FHeENoQyxFQUFlSCxFQUFZUSxhQUFhLFNBQVNwRCxnQkFHakRpRixFQUFjNUQsTUFBTSxJQUl4QjRELEVBQWN2RCxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9wcmFjdGljdW0vd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9wcmFjdGljdW0vd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtL3dlYnBhY2svcnVudGltZS9qc29ucCBjaHVuayBsb2FkaW5nIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbi8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBfX3dlYnBhY2tfbW9kdWxlc19fO1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmosIHByb3ApIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApOyB9IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmIgPSBkb2N1bWVudC5iYXNlVVJJIHx8IHNlbGYubG9jYXRpb24uaHJlZjtcblxuLy8gb2JqZWN0IHRvIHN0b3JlIGxvYWRlZCBhbmQgbG9hZGluZyBjaHVua3Ncbi8vIHVuZGVmaW5lZCA9IGNodW5rIG5vdCBsb2FkZWQsIG51bGwgPSBjaHVuayBwcmVsb2FkZWQvcHJlZmV0Y2hlZFxuLy8gW3Jlc29sdmUsIHJlamVjdCwgUHJvbWlzZV0gPSBjaHVuayBsb2FkaW5nLCAwID0gY2h1bmsgbG9hZGVkXG52YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1xuXHQxNzk6IDBcbn07XG5cbi8vIG5vIGNodW5rIG9uIGRlbWFuZCBsb2FkaW5nXG5cbi8vIG5vIHByZWZldGNoaW5nXG5cbi8vIG5vIHByZWxvYWRlZFxuXG4vLyBubyBITVJcblxuLy8gbm8gSE1SIG1hbmlmZXN0XG5cbi8vIG5vIG9uIGNodW5rcyBsb2FkZWRcblxuLy8gbm8ganNvbnAgZnVuY3Rpb24iLCIvLyBJbXBvcnQgaW1hZ2VzIGZvciB3ZWJwYWNrIHRvIGFkZCB0aGUgY29ycmVjdCBwYXRocyB0byB0aGUgdmFyaWFibGVzXG5jb25zdCBsYWdvRGlCcmFpZXNJbWFnZSA9IG5ldyBVUkwoXCIuLi9pbWFnZXMvbGFnby1kaS1icmFpZXMuanBnXCIsIGltcG9ydC5tZXRhLnVybCk7XG5jb25zdCB2YW5vaXNlTmF0aW9uYWxQYXJrSW1hZ2UgPSBuZXcgVVJMKFwiLi4vaW1hZ2VzL3Zhbm9pc2UtbmF0aW9uYWwtcGFyay5qcGdcIiwgaW1wb3J0Lm1ldGEudXJsKTtcbmNvbnN0IGxha2VMb3Vpc2VJbWFnZSA9IG5ldyBVUkwoXCIuLi9pbWFnZXMvbGFrZS1sb3Vpc2UuanBnXCIsIGltcG9ydC5tZXRhLnVybCk7XG5jb25zdCBsYXRlbWFySW1hZ2UgPSBuZXcgVVJMKFwiLi4vaW1hZ2VzL2xhdGVtYXIuanBnXCIsIGltcG9ydC5tZXRhLnVybCk7XG5jb25zdCBiYWxkTW91bnRhaW5zSW1hZ2UgPSBuZXcgVVJMKFwiLi4vaW1hZ2VzL2JhbGQtbW91bnRhaW5zLmpwZ1wiLCBpbXBvcnQubWV0YS51cmwpO1xuY29uc3QgeW9zZW1pdGVWYWxsZXlJbWFnZSA9IG5ldyBVUkwoXCIuLi9pbWFnZXMveW9zZW1pdGUtdmFsbGV5LmpwZ1wiLCBpbXBvcnQubWV0YS51cmwpO1xuXG4vLyBDcmVhdGUgYW4gaW5pdGlhbCBsaXN0IG9mIGNhcmRzXG5leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICAgIHtcbiAgICAgICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgICAgICBsaW5rOiBsYWdvRGlCcmFpZXNJbWFnZVxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgICAgICBsaW5rOiB2YW5vaXNlTmF0aW9uYWxQYXJrSW1hZ2VcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgICAgICBsaW5rOiBsYWtlTG91aXNlSW1hZ2VcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgICAgIGxpbms6IGxhdGVtYXJJbWFnZVxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgICAgIGxpbms6IGJhbGRNb3VudGFpbnNJbWFnZVxuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgICAgICBsaW5rOiB5b3NlbWl0ZVZhbGxleUltYWdlXG4gICAgfVxuXTtcblxuZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcbiAgICBjYXJkc0xpc3Q6ICcuY2FyZHNfX2xpc3QnLFxuICAgIGNhcmRUZW1wbGF0ZTogJyNjYXJkLWVsZW1lbnQnLFxuICAgIHByZXZpZXdQb3B1cDogJyNpbWFnZS1tb2RhbCcsXG4gICAgZWRpdEZvcm1Qb3B1cDogJyNlZGl0LW1vZGFsJyxcbiAgICBhZGRGb3JtUG9wdXA6ICcjYWRkLW1vZGFsJyxcbiAgICBwcm9maWxlTmFtZTogJy5wcm9maWxlX19uYW1lJyxcbiAgICBwcm9maWxlUHJvZmVzc2lvbjogJy5wcm9maWxlX19wcm9mZXNzaW9uJyxcbiAgICBmb3JtTW9kYWxDb250YWluZXI6ICcubW9kYWxfX2NvbnRhaW5lcicsXG4gICAgaW1hZ2VNb2RhbENvbnRhaW5lcjogJy5tb2RhbF9fcG9wdXAnLFxuICAgIGZvcm1JbnB1dE5hbWU6ICcjbmFtZScsXG4gICAgZm9ybUlucHV0UHJvZmVzc2lvbjogJyNwcm9mZXNzaW9uJyxcbn1cblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX2J1dHRvbl9kaXNhYmxlZFwiLFxuICAgIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gICAgZXJyb3JDbGFzczogXCJmb3JtX19lcnJvcl92aXNpYmxlXCIsXG4gICAgZm9ybVNlbGVjdG9yOiAnZm9ybScsXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gICAgY29uc3RydWN0b3IoeyBkYXRhLCBoYW5kbGVJbWFnZUNsaWNrIH0sIGNhcmRTZWxlY3Rvcikge1xuICAgICAgICAvLyBGaW5kIHRoZSBkYXRhJ3MgbmFtZSBhbmQgbGlua1xuICAgICAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgICAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuXG4gICAgICAgIC8vIEZpbmQgdGhlIGNhcmQgc2VsZWN0b3JcbiAgICAgICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuXG4gICAgICAgIC8vIEhhbmRsZSB0aGUgaW1hZ2UtY2xpY2sgZnVuY3Rpb25cbiAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgfVxuXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuXG4gICAgICAgIC8vIEFkZCBldmVudCBsaXN0bmVyIGZvciBsaWtlIGJ1dHRvblxuICAgICAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKTtcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2hhbmRsZUxpa2VJY29uKTtcblxuICAgICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXIgZm9yIHRoZSBkZWxldGUgYnV0dG9uXG4gICAgICAgIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKTtcbiAgICAgICAgZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCgpKTtcblxuICAgICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXIgZm9yIGltYWdlXG4gICAgICAgIHRoaXMuX2ltYWdlV2luZG93ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKTtcbiAgICAgICAgdGhpcy5faW1hZ2VXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHtsaW5rOiB0aGlzLl9saW5rLCBuYW1lOiB0aGlzLl9uYW1lfSkpO1xuICAgIH1cblxuICAgIF9oYW5kbGVMaWtlSWNvbiA9ICgpID0+IHtcbiAgICAgICAgLy8gQWRkIGFjdGl2ZSBjbGFzcyB0byBjYXJkJ3MgbGlrZSBidXR0b25cbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmUnKTtcbiAgICB9XG5cbiAgICBfaGFuZGxlRGVsZXRlQ2FyZCgpIHtcbiAgICAgICAgLy8gUmVtb3ZlIGVsZW1lbnQgZnJvbSB0aGUgRE9NIG9uIGNsaWNrXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG5cbiAgICAgICAgLy8gUmVtb3ZlIHRoZSBsaW5rIHRvIHRoZSBET00gZWxlbWVudFxuICAgICAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcbiAgICB9XG5cbiAgICBfZ2V0VGVtcGxhdGUoKSB7XG5cbiAgICAgICAgLy8gR2V0IGNhcmQgdGVtcGxhdGVcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50XG4gICAgICAgICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAgICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZCcpXG4gICAgICAgICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICAgIH1cblxuICAgIGdldFZpZXcoKSB7XG4gICAgICAgIFxuICAgICAgICAvLyBDcmVhdGUgY2FyZCB0ZW1wbGF0ZVxuICAgICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNldCB0aGUgaW1hZ2UgbGlua1xuICAgICAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpOyAgICAgICAgXG4gICAgICAgIGNhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgICAgICBjYXJkSW1hZ2UuYWx0ID0gYFBob3RvIG9mICR7dGhpcy5fbmFtZX1gO1xuXG4gICAgICAgIC8vIFNldCB0aGUgY2FyZCB0aXRsZVxuICAgICAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpO1xuICAgICAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgICAgIC8vIFNldCB0aGUgZXZlbnQgbGlzdGVuZXJzXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICAgIFxuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgICAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICAgICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG5cbiAgICAgICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gICAgfVxuXG4gICAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuXG4gICAgICAgIC8vIEdlbmVyYXRlIHRoZSBpZCBmb3IgZXJyb3IgZm9yIHRoZSB0YXJnZXQgZWxlbWVudFxuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgXG4gICAgICAgIC8vIEFkZCB0aGUgaW5wdXQgZXJyb3IgY2xhc3MgdG8gdGhlIGVsZW1lbnQncyBjbGFzcyBsaXN0XG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgXG4gICAgICAgIC8vIENoYW5nZSB0aGUgdGV4dCBjb250ZW50IHRvIHRoZSBlcnJvciBtZXNzYWdlXG4gICAgICAgIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgdGhlIGVycm9yIGNsYXNzIHRvIHRoZSBlcnJvciBtZXNzYWdlJ3MgY2xhc3MgbGlzdFxuICAgICAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gICAgfTtcblxuICAgIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcblxuICAgICAgICAvLyBHZW5lcmF0ZSB0aGUgaWQgZm9yIGVycm9yIGZvciB0aGUgdGFyZ2V0IGVsZW1lbnRcbiAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHRoZSBpbnB1dCBlcnJvciBjbGFzcyB0byB0aGUgZWxlbWVudCdzIGNsYXNzIGxpc3RcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcblxuICAgICAgICAvLyBDbGVhciB0aGUgZXJyb3IgbWVzc2FnZSBmcm9tIHRoZSB0ZXh0IGNvbnRlbnRcbiAgICAgICAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG5cbiAgICAgICAgLy8gQWRkIHRoZSBlcnJvciBjbGFzcyB0byB0aGUgZXJyb3IgbWVzc2FnZSdzIGNsYXNzIGxpc3RcbiAgICAgICAgZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIH07XG5cbiAgICAvLyBEaXNhYmxlIGZvcm0gYnV0dG9uXG4gICAgZGlzYWJsZUJ1dHRvbigpIHtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgfTtcblxuICAgIC8vIEVuYWJsZSBmb3JtIGJ1dHRvblxuICAgIF9lbmFibGVCdXR0b24gKCkge1xuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfTtcblxuICAgIC8vIFNob3cgb3IgaGlkZSBpbnB1dCBlcnJvcnMgYmFzZWQgb24gdGhlIGN1cnJlbnQgaW5wdXQgZWxlbWVudCdzIHZhbGlkaXR5XG4gICAgX3RvZ2dsZUlucHV0U3RhdGUoaW5wdXRFbGVtZW50KSB7XG4gICAgICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICAgICAgICAvLyBJZiBpbnB1dCBlbGVtZW50IGlzIGludmFsaWQsIHNob3cgaW5wdXQgZXJyb3IgbWVzc2FnZVxuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIE90aGVyd2lzZSwgaGlkZSBpbnB1dCBlcnJvciBtZXNzYWdlXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8vIENoZWNrIGlmIHRoZSBpbnB1dCBlbGVtZW50IGlzIGludmFsaWRcbiAgICBfY2hlY2tWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgYW55IGVsZW1lbnQgaW4gdGhlIGlucHV0IGxpc3QgaXMgaW52YWxpZFxuICAgIC8vIFJlZmVyZW5jZSAoMSk6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0FycmF5L3NvbWVcbiAgICAvLyBSZWZlcmVuY2UgKDIpOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9BcnJheS9mcm9tXG4gICAgX2hhc0ludmFsaWRJbnB1dCA9ICgpID0+IEFycmF5LmZyb20odGhpcy5faW5wdXRMaXN0KS5zb21lKHRoaXMuX2NoZWNrVmFsaWRpdHkpO1xuXG4gICAgLy8gVG9nZ2xlIGJ1dHRvbiBkZXBlbmRpbmcgb24gdGhlIGlucHV0J3MgdmFsaWRpdHlcbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG5cbiAgICAgICAgLy8gSWYgdGhlIGlucHV0IGlzIHZhbGlkLCBkaXNhYmxlIHRoZSBidXR0b25cbiAgICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XG4gICAgICAgICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIE90aGVyd2lzZSwgZW5hYmxlIHRoZSBidXR0b25cbiAgICAgICAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBcbiAgICAvLyBTZXQgZXZlbnQgbGlzdGVuZXJzIGZvciBmb3JtIGVsZW1lbnRzIGJhc2VkIG9uIHRoZSB1c2VyIGlucHV0cycgdmFsaWRpdHlcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG5cbiAgICAgICAgLy8gRGlzYWJsZSBidXR0b25cbiAgICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG5cbiAgICAgICAgLy8gTGlzdGVuIGZvciB0aGUgXCJ0eXBlXCIgZXZlbnQgb24gZWFjaCBpbnB1dFxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVJbnB1dFN0YXRlKGlucHV0RWxlbWVudCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSBmb3JtXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xuXG4gICAgICAgICAgICAvLyBQcmV2ZW50IHRoZSBmb3JtJ3MgZGVmYXVsdCBiZWhhdmlvdXJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gU2V0IGV2ZW50IGxpc3RlbmVyc1xuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIH1cblxuICAgIHJlc2V0VmFsaWRhdGlvbigpIHtcblxuICAgICAgICAvLyBSZXNldCBzdWJtaXQgYnV0dG9uXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG5cbiAgICAgICAgLy8gQ2xlYXIgZXJyb3IgbWVzc2FnZXNcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KVxuICAgICAgICB9KTtcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UtYnV0dG9uJyk7XG4gICAgfVxuXG4gICAgb3BlbigpIHtcblxuICAgICAgICAvLyBvcGVuIHBvcHVwXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdtb2RhbF9vcGVuZWQnKTtcblxuICAgICAgICAvLyBMaXN0ZW4gZm9yIHRoZSBcIkVzY2FwZVwiIGtleSBldmVudFxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIH1cblxuICAgIGNsb3NlKCkge1xuXG4gICAgICAgIC8vIGNsb3NlIHBvcHVwXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdtb2RhbF9vcGVuZWQnKTtcblxuICAgICAgICAvLyBSZW1vdmUgbGlzdGVuZXIgZm9yIHRoZSBcIkVzY2FwZVwiIGtleSBldmVudFxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIH1cblxuICAgIF9oYW5kbGVFc2NDbG9zZSA9IChldmVudCkgPT4ge1xuXG4gICAgICAgIC8vIFByZXZlbnQgZGVmYXVsdCBhbmQgaWYgZXZlbnQgd2FzIG9uIEVTQyBidXR0b24gY2FsbCB0aGUgXCJjbG9zZVwiIG1ldGhvZFxuICAgICAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcblxuICAgICAgICAvLyBDbG9zZSB0aGUgcG9wdXAgd2hlbiB1c2VycyBjbGljayBvbiB0aGUgc2hhZGVkIGFyZWEgb3V0c2lkZSB0aGUgbW9kYWxcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSBldmVudC5jdXJyZW50VGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuXG4gICAgICAgIC8vIENsb3NlIHRoZSBwb3B1cCB3aGVuIHVzZXJzIGNsaWNrIG9uIHRoZSAnY2xvc2UnIGJ1dHRvblxuICAgICAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuY2xvc2UoKSk7XG4gICAgfVxufSIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fZm9ybScpO1xuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm1fX2J1dHRvbicpO1xuICAgICAgICB0aGlzLl9mb3JtSW5wdXRzID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFwiKTtcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgfVxuXG4gICAgLy8gQ29sbGVjdHMgZGF0YSBmcm9tIGFsbCB0aGUgaW5wdXQgZmllbGRzIGFuZCByZXR1cm5zIHRoZSBkYXRhIGFzIGFuIG9iamVjdFxuICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcblxuICAgICAgICAvLyBNYWtlIGEgaW5wdXQgZGF0YSBvYmplY3RcbiAgICAgICAgY29uc3QgaW5wdXRPYmplY3QgPSB7fTtcblxuICAgICAgICAvLyBOYW1lIGVhY2ggaW5wdXQgYnkgaXRzIHZhbHVlXG4gICAgICAgIHRoaXMuX2Zvcm1JbnB1dHMuZm9yRWFjaChpbnB1dCA9PiB7XG4gICAgICAgICAgICBpbnB1dE9iamVjdFtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgICAgICB9KVxuICAgICAgICBcbiAgICAgICAgLy8gUmV0dXJuIHRoZSBkYXRhIGFzIGFuIG9iamVjdFxuICAgICAgICByZXR1cm4gaW5wdXRPYmplY3Q7XG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG5cbiAgICAgICAgLy8gQWRkIHRoZSAnY2xpY2snIGV2ZW50IGxpc3RlbmVyIHRvIHRoZSBjbG9zZSBpY29uXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICAgICAgLy8gQWRkIHRoZSAnc3VibWl0JyBldmVudCBoYW5kbGVyIHRvIHRoZSBmb3JtXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIGNsb3NlKCkge1xuICAgICAgICBcbiAgICAgICAgLy8gUmVzZXQgdGhlIGZvcm1cbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG5cbiAgICAgICAgLy8gQ2xvc2UgdGhlIGZvcm1cbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcbiAgICB9XG59IiwiaW1wb3J0ICcuL2luZGV4LmNzcyc7XG5pbXBvcnQgeyBpbml0aWFsQ2FyZHMsIHNlbGVjdG9ycywgdmFsaWRhdGlvblNldHRpbmdzIH0gZnJvbSAnLi4vdXRpbHMvY29uc3RhbnRzJztcblxuLy8gSW1wb3J0IGFsbCB0aGUgY2xhc3Nlc1xuaW1wb3J0IENhcmQgZnJvbSAnLi4vY29tcG9uZW50cy9DYXJkJztcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gJy4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvcic7XG5pbXBvcnQgU2VjdGlvbiBmcm9tICcuLi9jb21wb25lbnRzL1NlY3Rpb24nO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UnO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtJztcbmltcG9ydCBVc2VySW5mbyBmcm9tICcuLi9jb21wb25lbnRzL1VzZXJJbmZvJztcblxuLy8gSWRlbnRpZnkgZWRpdCwgYWRkIGFuZCBjbG9zZSBidXR0b25zIGFzIGVsZW1lbnRzXG5jb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnV0dG9uJyk7XG5jb25zdCBhZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xuXG4vLyBGaW5kIGVkaXQgZm9ybSBpbnB1dCBlbGVtZW50c1xuY29uc3QgZm9ybUlucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuYW1lJyk7XG5jb25zdCBmb3JtSW5wdXRQcm9mZXNzaW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2Zlc3Npb24nKTtcblxuLy8gRmluZCBmb3JtIGVsZW1lbnRzXG5jb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zWydwcm9maWxlLWZvcm0nXTtcbmNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXNbJ2NhcmQtZm9ybSddO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRm9ybSBWYWxpZGF0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIENyZWF0ZSBhIGZvcm0gdmFsaWRhdG9ycyBvYmplY3RcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XG5cbi8vIENyZWF0ZSB2YWxpZGF0b3IgaW5zdGFuY2VzIGZvciBhbGwgZm9ybXNcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAodmFsaWRhdGlvblNldHRpbmdzKSA9PiB7XG5cbiAgICAvLyBDcmVhdGUgYW4gYXJyYXkgb2YgYWxsIGZvcm1zXG4gICAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodmFsaWRhdGlvblNldHRpbmdzLmZvcm1TZWxlY3RvcikpO1xuXG4gICAgLy8gQ3JlYXRlIGEgdmFsaWRhdG9yIGZvciBlYWNoIGZvcm1cbiAgICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuXG4gICAgICAgIC8vIENyZWF0ZSBhIHZhbGlkYXRvciBpbnN0YW5jZSBmb3IgdGhlIGN1cnJlbnQgaW5zdGFuY2VcbiAgICAgICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBmb3JtRWxlbWVudCk7XG5cbiAgICAgICAgLy8gUmV0cmlldmUgdGhlIGZvcm0gZWxlbWVudCBieSBpdHMgbmFtZVxuICAgICAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZSgnbmFtZScpO1xuXG4gICAgICAgIC8vIFN0b3JlIHRoZSBjdXJyZW50IGZvcm0gdmFsaWRhdG9yIGluIHRoZSB2YWxpZGF0b3JzIG9iamVjdFxuICAgICAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XG5cbiAgICAgICAgLy8gRW5hYmxlIHZhbGlkYXRpb24gZm9yIHRoZSBjdXJyZW50IGZvcm1cbiAgICAgICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiAgICB9KTtcbn07XG5cbi8vIEVuYWJsZSB2YWxpZGF0aW9uIGZvciBhbGwgZm9ybXNcbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvblNldHRpbmdzKTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUG9wdXAgSW1hZ2UgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vLyBDcmVhdGUgaW1hZ2UgcG9wdXAgaW5zdGFuY2VcbmNvbnN0IGNhcmRQcmV2aWV3UG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoc2VsZWN0b3JzLnByZXZpZXdQb3B1cCk7XG5cbi8vIENsb3NlIGltYWdlIHBvcHVwIHByZXZpZXdcbmNhcmRQcmV2aWV3UG9wdXAuY2xvc2UoKTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDYXJkIFNlY3Rpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vLyBUaGlzIGZ1bmN0aW9uIGNyZWF0ZXMgYSBuZXcgY2FyZFxuZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhKSB7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBuZXcgQ2FyZCh7IGRhdGEsIGhhbmRsZUltYWdlQ2xpY2s6IChpbWFnZURhdGEpID0+IHtcbiAgICAgICAgY2FyZFByZXZpZXdQb3B1cC5vcGVuKGltYWdlRGF0YSk7XG5cbiAgICB9fSwgc2VsZWN0b3JzLmNhcmRUZW1wbGF0ZSk7XG5cbiAgICByZXR1cm4gY2FyZEVsZW1lbnQuZ2V0VmlldygpO1xufVxuXG4vLyBDcmVhdGUgYSBzZWN0aW9uIG9mIGNhcmRzXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgIHtcbiAgICAgICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICAgICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSBhIG5ldyBjYXJkXG4gICAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoZGF0YSk7XG5cbiAgICAgICAgICAgIC8vIERpc3BsYXkgZWFjaCBjYXJkXG4gICAgICAgICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICAgICAgfSxcbiAgICB9LFxuICAgIHNlbGVjdG9ycy5jYXJkc0xpc3Rcbik7XG5cbi8vIFJlbmRlciB0aGUgaW5pdGlhbCBsaXN0IG9mIGNhcmRzIG9uIHRoZSBwYWdlXG5jYXJkU2VjdGlvbi5yZW5kZXJJdGVtcyhpbml0aWFsQ2FyZHMpO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQWRkIEZvcm0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblxuLy8gQ3JlYXRlIHRoZSBhZGQgZm9ybSBpbnN0YW5jZVxuY29uc3QgYWRkRm9ybVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oc2VsZWN0b3JzLmFkZEZvcm1Qb3B1cCwgKGZvcm1EYXRhKSA9PiB7XG5cbiAgICAvLyBDcmVhdGUgYSBuZXcgY2FyZFxuICAgIGNvbnN0IG5ld0NhcmQgPSBjcmVhdGVDYXJkKGZvcm1EYXRhKTtcbiAgICBcbiAgICAvLyBDbG9zZSB0aGUgYWRkIGZvcm1cbiAgICBhZGRGb3JtUG9wdXAuY2xvc2UoKTtcblxuICAgIC8vIEFkZCB0aGUgbmV3IGNhcmQgdG8gdGhlIHNlY3Rpb25cbiAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKG5ld0NhcmQpO1xufSk7XG5cbi8vIE9wZW4gdGhlIG1vZGFsIHdoZW4gdXNlcnMgY2xpY2sgb24gdGhlIGFkZCBidXR0b25cbmFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIFxuICAgIC8vIFJlc2V0IHZhbGlkYXRpb24gZm9yIHRoZSBhZGQgY2FyZCBmb3JtXG4gICAgZm9ybVZhbGlkYXRvcnNbYWRkQ2FyZEZvcm0uZ2V0QXR0cmlidXRlKCduYW1lJyldLnJlc2V0VmFsaWRhdGlvbigpO1xuXG4gICAgLy8gT3BlbiB0aGUgYWRkIGNhcmQgZm9ybVxuICAgIGFkZEZvcm1Qb3B1cC5vcGVuKCk7XG59KTtcblxuLy8gU2V0IGFkZCBmb3JtIGV2ZW50IGxpc3RlbmVyc1xuYWRkRm9ybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQcm9maWxlIEluZm9ybWF0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vLyBDcmVhdGUgdGhlIHVzZXIgaW5mbyBpbnN0YW5jZVxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oc2VsZWN0b3JzLnByb2ZpbGVOYW1lLCBzZWxlY3RvcnMucHJvZmlsZVByb2Zlc3Npb24pO1xuXG4vLyBDcmVhdGUgdGhlIGVkaXQgZm9ybSBpbnN0YW5jZVxuY29uc3QgZWRpdEZvcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHNlbGVjdG9ycy5lZGl0Rm9ybVBvcHVwLCAodmFsdWVzKSA9PiB7XG5cbiAgICAvLyBBZGQgdGhlIGZvcm0ncyBpbnB1dCB0byB0aGUgcHJvZmlsZSBzZWN0aW9uXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8odmFsdWVzLm5hbWUsIHZhbHVlcy5wcm9mZXNzaW9uKTtcblxuICAgIC8vIENsb3NlIHRoZSBlZGl0IGZvcm1cbiAgICBlZGl0Rm9ybVBvcHVwLmNsb3NlKCk7XG59KTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVkaXQgRm9ybSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vLyBPcGVuIHRoZSBtb2RhbCB3aGVuIHVzZXJzIGNsaWNrIG9uIHRoZSBlZGl0IGJ1dHRvblxuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXG4gICAgLy8gR2V0IHByb2ZpbGUgaW5mbyBhbmQgYWRkIHRvIHRoZSBmb3JtIGZpZWxkc1xuICAgIGNvbnN0IHByb2ZpbGVJbmZvID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcblxuICAgIC8vIEFkZCB0aGUgcHJvZmlsZSBpbmZvIG9uIHRoZSBwYWdlIHRvIHRoZSBmb3JtJ3MgZmllbGRzXG4gICAgZm9ybUlucHV0TmFtZS52YWx1ZSA9IHByb2ZpbGVJbmZvLm5hbWU7XG4gICAgZm9ybUlucHV0UHJvZmVzc2lvbi52YWx1ZSA9IHByb2ZpbGVJbmZvLnByb2Zlc3Npb247XG5cbiAgICAvLyBEaXNhYmxlIGJ1dHRvbiBlYWNoIHRpbWUgaXQgb3BlbnNcbiAgICBmb3JtVmFsaWRhdG9yc1twcm9maWxlRm9ybS5nZXRBdHRyaWJ1dGUoJ25hbWUnKV0uZGlzYWJsZUJ1dHRvbigpO1xuXG4gICAgLy8gT3BlbiBtb2RhbFxuICAgIGVkaXRGb3JtUG9wdXAub3BlbigpO1xufSk7XG5cbi8vIFNldCBlZGl0IGZvcm0gZXZlbnQgbGlzdGVuZXJzXG5lZGl0Rm9ybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7IiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICAgICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW1hZ2UnKTtcbiAgICAgICAgdGhpcy5faW1hZ2VDYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fbmFtZScpO1xuXG4gICAgICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuICAgIFxuICAgIG9wZW4oaW1hZ2VEYXRhKSB7XG4gICAgICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zcmMgPSBpbWFnZURhdGEubGluaztcbiAgICAgICAgdGhpcy5faW1hZ2VFbGVtZW50LmFsdCA9IGBJbWFnZSAke2ltYWdlRGF0YS5uYW1lfWA7XG4gICAgICAgIHRoaXMuX2ltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IGltYWdlRGF0YS5uYW1lO1xuICAgICAgICBzdXBlci5vcGVuKCk7XG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yICkge1xuICAgICAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zID0gaXRlbXM7XG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICAgIH1cblxuICAgIHJlbmRlckl0ZW1zKCkge1xuICAgICAgICAvLyBSZW5kZXJzIGFsbCBlbGVtZW50cyBvbiB0aGUgcGFnZVxuICAgICAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGFkZEl0ZW0oZWxlbWVudCl7XG4gICAgICAgIC8vIEFkZHMgdGhlIERPTSBlbGVtZW50IHRvIHRoZSBjb250YWluZXJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgICBjb25zdHJ1Y3RvcihuYW1lU2VsZWN0b3IsIHByb2Zlc3Npb25TZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9wcm9mZXNzaW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9mZXNzaW9uU2VsZWN0b3IpO1xuICAgIH1cblxuICAgIC8vIFJldHJpZXZlIHByb2ZpbGUgaW5mbyBmcm9tIHRoZSBwYWdlXG4gICAgZ2V0VXNlckluZm8oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxuICAgICAgICAgICAgcHJvZmVzc2lvbjogdGhpcy5fcHJvZmVzc2lvbi50ZXh0Q29udGVudCxcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFkZCBuZXcgcHJvZmlsZSBpbmZvIHRvIHRoZSBwYWdlXG4gICAgc2V0VXNlckluZm8obmFtZSwgcHJvZmVzc2lvbikge1xuICAgICAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICAgICAgdGhpcy5fcHJvZmVzc2lvbi50ZXh0Q29udGVudCA9IHByb2Zlc3Npb247XG4gICAgfVxufSJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsIm0iLCJvIiwib2JqIiwicHJvcCIsIk9iamVjdCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInAiLCJiIiwiZG9jdW1lbnQiLCJiYXNlVVJJIiwic2VsZiIsImxvY2F0aW9uIiwiaHJlZiIsImluaXRpYWxDYXJkcyIsIm5hbWUiLCJsaW5rIiwiVVJMIiwiQ2FyZCIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImNhcmRTZWxlY3RvciIsImRhdGEiLCJoYW5kbGVJbWFnZUNsaWNrIiwidGhpcyIsIl9uYW1lIiwiX2xpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfbGlrZUJ1dHRvbiIsIl9lbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlTGlrZUljb24iLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9pbWFnZVdpbmRvdyIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInJlbW92ZSIsIl9nZXRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJnZXRWaWV3IiwiY2FyZEltYWdlIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtIiwiX2lucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlRWxlbWVudCIsImlkIiwiYWRkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJkaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwiX3RvZ2dsZUlucHV0U3RhdGUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrVmFsaWRpdHkiLCJfaGFzSW52YWxpZElucHV0IiwiQXJyYXkiLCJmcm9tIiwic29tZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfY2xvc2VCdXR0b24iLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfZm9ybUlucHV0cyIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRPYmplY3QiLCJpbnB1dCIsInZhbHVlIiwicmVzZXQiLCJlZGl0QnV0dG9uIiwiYWRkQnV0dG9uIiwiZm9ybUlucHV0TmFtZSIsImZvcm1JbnB1dFByb2Zlc3Npb24iLCJwcm9maWxlRm9ybSIsImZvcm1zIiwiYWRkQ2FyZEZvcm0iLCJmb3JtVmFsaWRhdG9ycyIsInZhbGlkYXRpb25TZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIiwiY2FyZFByZXZpZXdQb3B1cCIsIl9pbWFnZUVsZW1lbnQiLCJfaW1hZ2VDYXB0aW9uIiwiaW1hZ2VEYXRhIiwiY3JlYXRlQ2FyZCIsImNhcmRTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX3JlbmRlcmVkSXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiY2FyZEVsZW1lbnQiLCJhZGRGb3JtUG9wdXAiLCJmb3JtRGF0YSIsIm5ld0NhcmQiLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsInByb2Zlc3Npb25TZWxlY3RvciIsIl9wcm9mZXNzaW9uIiwiZ2V0VXNlckluZm8iLCJwcm9mZXNzaW9uIiwic2V0VXNlckluZm8iLCJlZGl0Rm9ybVBvcHVwIiwidmFsdWVzIiwicHJvZmlsZUluZm8iXSwic291cmNlUm9vdCI6IiJ9